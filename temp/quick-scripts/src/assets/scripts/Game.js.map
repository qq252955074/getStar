{"version":3,"sources":["assets\\scripts\\Game.js"],"names":["cc","Class","Component","properties","startPrefab","type","Prefab","maxStarDuration","minStarDuration","ground","Node","player","scoreDisplay","Label","scoreAudio","AudioClip","onLoad","groundY","y","height","startDuration","timer","spawnNewStar","score","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","Math","random","getComponent","game","randX","randY","jumpHeight","maxX","width","v2","gainScore","string","audioEngine","playEffect","gameOver","stopAllActions","director","loadScene","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        //这个属性引用星星的预制资源\r\n        startPrefab:{\r\n            default:null,\r\n            type:cc.Prefab\r\n        },\r\n        maxStarDuration:0,\r\n        minStarDuration:0,\r\n        ground:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        player:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        scoreDisplay:{\r\n           default:null,\r\n            type:cc.Label\r\n        },\r\n        scoreAudio:{\r\n            //得分音效\r\n            default:null,\r\n            type:cc.AudioClip\r\n        }\r\n    },\r\n\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    onLoad: function(){\r\n        //获取地平面y轴的坐标\r\n        this.groundY=this.ground.y+this.ground.height/2;\r\n        this.startDuration=0;\r\n        this.timer=0;\r\n        //生成一个人小星星\r\n        this.spawnNewStar();\r\n        this.score=0;\r\n  \r\n    },\r\n    spawnNewStar:function(){\r\n        //使用给定的模板在场景中生成一个新的节点\r\n        var newStar = cc.instantiate(this.startPrefab);\r\n        //将新增的节点挂在在Canvas节点下面\r\n        this.node.addChild(newStar);\r\n        newStar.setPosition(this.getNewStarPosition());\r\n        this.startDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n        //在星星组件上暂存Game对象的引用\r\n        newStar.getComponent('Star').game = this;\r\n\r\n    },\r\n    getNewStarPosition:function(){\r\n        var randX=0;\r\n        //根据地平面的位置和主角的跳跃高度，随机得到一个星星的y坐标\r\n        var randY = this.groundY+Math.random() * this.player.getComponent('Player').jumpHeight+50;\r\n        //根据屏幕的宽度,随机得到一个星星x的坐标\r\n        var maxX = this.node.width/2;\r\n        randX = (Math.random()-0.5) * 2 * maxX;\r\n        return cc.v2(randX,randY);\r\n    },\r\n    gainScore:function(){\r\n        this.score +=1;\r\n        //更新label的文字\r\n        this.scoreDisplay.string='Score: '+this.score;\r\n        cc.audioEngine.playEffect(this.scoreAudio,false);\r\n    },\r\n    gameOver:function(){\r\n        this.player.stopAllActions(); //停止 player 节点的跳跃动作\r\n        cc.director.loadScene('game');\r\n    },\r\n    update:function(dt){\r\n        //判断是否超时\r\n         if(this.timer>this.startDuration)\r\n        {\r\n            this.gameOver();\r\n            return;\r\n        }\r\n         this.timer +=dt;\r\n    },\r\n\r\n    \r\n});\r\n\r\n\r\n\r\n"]}